<!doctype html>
<html lang=en-us>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Colliding Black Holes</title>  
        <link rel="stylesheet" href="BHCollide.css">
    </head>
    <body>
        <script src="https://threejs.org/build/three.min.js"></script>
        <script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
        <script src="https://unpkg.com/delaunator@3.0.2/delaunator.js"></script> 
        <!-- https://github.com/mapbox/delaunator -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.3/dat.gui.min.js"></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
        <script src="delaunaymesh.js"></script> 
        <script src = "BHCollidePlot.js"></script>
        <script src="BHCollideSim.js"></script>

        <!-- Simulation Control Panel start -->
        <div id="controlPanel">
            <div id="buttons">
                <button id="runButton" onclick="javascript:runSim();">Run Simulation</button>
                <button id="stopButton" onclick="javascript:stopSim();" disabled>Stop</button>
                <div id="dropdown">
                    <select name="function" id="fx" onchange="changeUp();">
                        <option value="0">ADD00GF</option>
                        <option value="1">ADD01GF</option>
                        <option value="2">ADD02GF</option>
                        <option value="3">ADD11GF</option>
                        <option value="4">ADD12GF</option>
                        <option value="5">ADD22GF</option>
                        <option value="6">ALPHAGF</option>
                        <option value="7">BETU0GF</option>
                        <option value="8">BETU1GF</option>
                        <option value="9">BETU2GF</option>
                        <option value="10" selected="selected">CFGF</option>
                        <option value="11">HDD00GF</option>
                        <option value="12">HDD01GF</option>
                        <option value="13">HDD02GF</option>  
                        <option value="14">HDD11GF</option>
                        <option value="15">HDD12GF</option>
                        <option value="16">HDD22GF</option>
                        <option value="17">LAMBDAU0GF</option>
                        <option value="18">LAMBDAU1GF</option>
                        <option value="19">LAMBDAU2GF</option>
                        <option value="20">TRKGF</option>
                        <option value="21">VETU0GF</option>
                        <option value="22">VETU1GF</option>
                        <option value="23">VETU2GF</option>
                    </select>
                </div>
                <button id="nextButton" onclick="javascript:nextSlice();" disabled>Step Forward</button>
                <button id="animateButton" onclick="javascript:animateSim();" disabled>Animate</button>
            </div>
            <div id="progressBar">
                <div id="progressDisplay"></div>
            </div>
        </div>
        <!-- Simulation Control Panel end -->

        <!-- info button -->
        <div id="luneLogo">
            i <!-- UTF-8 info character ðŸ›ˆ, not working on mobile? -->
        </div>
        <!-- info button end --> 

        <!-- Pop-up info page start-->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h1>Welcome to Lune's Colliding Black Hole Simulator!</h1>
                <p>This website simulates two black holes colliding and visualizes the components of Einstein's field equations with the click of a button. Usually, these types of simulations are run on supercomputers, but the folks at BlackHoles@Home found a way to dramatically reduce the required memory. Using a modifed version of their NRPY+ code, a python-based code generation software package, and Emscripten, a C/C++ compiler to WebAssembly, we were able to run a binary black hole collision in a browser!</p>

                <h2>What am I Simulating?</h2>
                <p>Black holes are simulated by solving Einstein's field equations for general relativity and integrating those equations over time. Einstein's equations describe the geometry of a 4-D spacetime, and thus there are many different functions within those equations we can graph. To visualize the collision in 3D, we take two spatial dimensions (x,y) and let z be one of the many functions our program records during the simulation. Each static image is called a "spatial slice" and represents what a function looks like at any particular point along a 2D field at one moment in time. These spatial slices are all stacked on top of one another to compose our 3D world, and each changes as time goes on. Changes in theses functions can tell us a lot about how spacetime changes in a collision. See <a href=#functions>The Lapse Function, Conformal Factor and More</a> for a description of some of these functions.
                <br><br>The NRPY+ code simulates two colliding black holes by taking Brill-Lindquist initial data for a binary black hole system and integrating it forward in time using the Method of Lines and RK4 time-stepping algorithm (see <a href=#MoLRK4>Method of Lines and Runge-Kutta 4th-Order Method</a>). This is done in using the BSSN 3+1 formalism of Einstein's field equations for general relativity (see <a href=#EFE>Einstein's Field Equations in BSSN</a>). The simulation records the evolution of 24 different functions using in the BSSN equations. Based on the selected function, the program will display the function on a 2D spatial slice and show the progression over a set number of time-steps.</p>
                <h3>Running the Simulator</h3>
                <p>When you first open the page click "Run Simulation" to run the simulation. The program will take about 20 seconds to finish. After the program has run once, you will be able to graph all 24 different functions! Select a function to visualize via the drop-down menu, and then click "Step Forward" to move forward one time-step, or "Animate" to see the whole simulation start to finish. Note that some functions do not change, or have very subtle changes, especially when moving just one time-step forward.</p>
                <h3 id="functions">The Lapse Function, Conformal Factor and More</h3>
                <p>The simulation records the evolution of 24 different functions within the BSSN equations. Here we will highlight a few.</p>
                <h4>Lapse Function: \(Î±\)</h4>
                <h4>Shift Function: \(Î²^i\)</h4>
                <h4>Conformal Factor: \(e^Ï†\)</h4>
                <h4>Trace of Extrinsic Curvature: \(K\)</h4>
                <h3 id="EFE">Einstein's Field Equations in BSSN</h3>   
                <p>Einstein's field equations describe how mass, specifically the distribution of mass, affects the geometry of a 4D spacetime(3 spatial dimensions, one time dimension). In this theory, gravity is caused by a dip in spacetime which acts like the side of a bowl, pulling objects into the center. These equations have many different formalisms that cater specifically to various relativistic problems. ADM 3+1 formalism splits 4D spacetime vectors into a 3D spatial vector and 1D time component and reformulates Einstein's equations accordingly. BSSN formalism is a reformulation of the standard ADM 3+1 equations that aims to improve the perfomance of numerical implementations of 3+1 such as the evolutions of binary black hole evolutions.</p>
                    
                <p>One notable difference is that the spatial metric is decomposed into a comformaly related spatial metric and an additional conformal factor. Another difference is that the extrinsic curvature is broken into its trace and a traceless counter part.</p>
                <h3>Method of Lines and Runge-Kutta 4th-Order Method</h3>
                
                <h2>Motivation</h2>
                <p>This project was inspired by the BlackHoles@Home project and their work making binary black hole simulations that can fit onto consumer-grade desktops. We wanted to take this one step further, and make these simulations even more accessible by creating a browser-based simulator that would be intuitive to the general public. That way, anyone, regardless of skill level, would be able to access these simulations. Additionally, anyone desiring a more advanced handling can check out the NRPY+ tutorial notebook this program was based off of.</p>

                <p>For more information on NRPY+ and BlackHoles@Home 
                    <a href="http://astro.phys.wvu.edu/bhathome/" target="_blank">
                    <img id="BHlogo" src="BH@Hlogo.png" alt=""></a></p>
                <p>For more information on Emscripten
                    <a href="https://emscripten.org/index.html" target="_blank">
                    <img id="emscriptenlogo" src="EmscriptenLogo.png" alt=""></a></p>
                <h2>Contact Info</h3>
            </div>
        </div>
        <!-- Pop-up info page end-->

        <script type="text/javascript">
            document.getElementById("progressBar").style.visibility = "hidden";

            var modal = document.getElementById("myModal");
            var infoBtn = document.getElementById("luneLogo");
            var span = document.getElementsByClassName("close")[0];

            infoBtn.onclick = function() {
                modal.style.display = "block";
            }

            span.onclick = function() {
                modal.style.display = "none";
            }

            renderCanvas(document.body);
       </script>
    </body>  
<html>
